---
title: 'The Math of "The Big Short" (But Even Shorter) '
date: 2025-06-05
permalink: /posts/2025/06/CDS/
tags:
  - 
  - 
excerpt: 
---

If you are here, you've probably watched "The Big Short". The 2015 film directed by Adam McKay centers around the events that led to the 2008 financial collapse. Unfortunately for us, the viewers, Wall Street is laden with strange acronyms and terminology which we had unwittingly thrust on to us during the movie’s 130-minute runtime. And while we are thankful to McKay for the film's short asides where Margo Robbie, Selena Gomez, and Anthony Bourdain explain what in the world collateralized debt obligations (CDO) or credit default swaps (CDS) are, you may have still left the theater a tad confused. So, while I can’t hire Margo Robie to explain the math behind some of these financial instruments, I'll do my best in today's blog post. We'll start by walking through models for credit default swaps and collateralized debt obligations that don’t use overly complicated mathematical machinery. Our primary objective will be to develop the tools to model the big short that the film's protagonists pulled off. 

Credit Default Swaps
-----

A credit default swap, put simply is insurance. Assume for a moment, that Bob has a bond which pays out $$\$100$$ at some expiration date in the future. However, there is a risk that the bond defaults at some time $$\tau \leq T$$, in which case Bob gets nothing. Considering the risk, Bob decides to look for a way to hedge against the risk that his bond defaults. Bob decides to pay for insurance. Every month Bob will pay Alice some premium so that if the bond defaults Bob can ask Alice for a piece of the $$\$100$$ he was expecting. On this flip side, if the bond doesn’t default, then Alice gets to keep the premium and doesn’t have to give Bob a cent. Let’s formalize this interaction.
 

#### Assumptions
- (i) Let $$0=T_1 < T_1 < \dots < T_n = T, \quad \Delta t = \frac{T}{n}$$. (i.e there are $$n$$ months between Bob purchasing the insurance policy and the maturity date of the bond)
- (ii) Bob pays Alice a premium of $$C\Delta t$$ every month $$T_i$$ until either maturity of the bond $$T$$ or the bond defaults at $$\tau \leq T$$ (i.e Bob pays at every month $$T_i \leq \max(T,\tau)$$
- (iii) If the bond defaults at time $$\tau$$ such that $$T_{i-1}<\tau \leq T_i$$, then Alice pays Bob some payout $$1-\delta$$ in month $$T_i$$
- (iv) Assume that the probability of the bond defaulting any time after month $$T_i$$ is $$\mathbb{P}(\tau > T_i) = e^{-\lambda t}$$. In other words, after every month that the bond does not default, the probability of default shrinks exponentially. *We are functionally treating a default event as an exponential random variable*
- (v) $$r$$ is the constant interest rate during the $$n$$ months Bob owns the bond. 

Using these assumptions, we can model the expected amount Bob will owe Alice after $$n$$ months of owning the insurance policy. We will call this value $$b_0$$, which can be computed by summing over all discounted premiums Bob pays until the bond matures or the bond defaults. 

$$b_0 = \sum_{i=1}^n \mathbb{E}[C \Delta t e^{-r T_i} \mathbb{I}_{\tau > T_i}]$$

$$\quad = C \sum_{i=1}^n \Delta t e^{-r T_i} e^{-\lambda T_i}$$

$$\quad = C \sum_{i=1}^n \Delta t e^{-(r+\lambda) T_i}$$

We can also model the expected amount that Alice will have to pay Bob. We will call this value $$a_0$$, which can be computed by summing over all payments Alice makes to Bob over the course of the $$n$$ month insurance policy. In this case our model is easier since $$a_0$$ is just the discounted payout $$(1-\delta)$$ times the probability that a default occurs at month $$T_i$$

$$a_0 = \sum_{i=1}^n \mathbb{E}[e^{-rT_i}(1-\delta)\mathbb{I}_{T_{i-1} < \tau \leq T_i}]$$

$$\quad = -(1 - \delta) \sum_{i=1}^n \mathbb{E}\left[ e^{-r T_i} \left( e^{-\lambda T_i} - e^{-\lambda T_{i-1}} \right) \right]$$


The question for you, the reader, is how expensive should Bob's premium be? One possible answer is that we should choose $$C$$ such that $$a_0 = b_0$$, since at the beginning of the interaction neither Alice or Bob should have an earning advantage over the other. This is called the risk neutral or the "fair" price. An unfair price would be one where $$C$$ is chosen such that $$a_0 < b_0$$. In that case Alice could keep selling Bob insurance and in the long run Alice would turn a profit. Now you might be asking yourself isn't that how an insurance company stays profitable. Yes, it is, an insurance company unsurprisingly makes money by giving you, the insure, an "unfair price" for your policy. But let’s not get political, and instead solve for the theoretically "fair" value of $$C$$. 

$$b_0 = C \sum_{i=1}^n \Delta t e^{-(r+\lambda) T_i} = -(1-\delta) \sum_{i=1}^n \mathbb{E}[e^{-rT_i}(e^{-\lambda T_{i}-e^{-\lambda T_{i-1}) = a_0$$

Let now take $$n \rightarrow \infty$$, in which case these sums become integrals

$$C \int_{0}^T e^{-(r+\lambda)t}dt = -(1-\delta) \int_{0}^T e^{-rt}(de^{-\lambda t})$$

$$C \int_{0}^T e^{-(r+\lambda)t}dt =  -(1-\delta) \int_{0}^T e^{-rt}(-\lambda e^{-\lambda t}dt)$$

$$C \int_{0}^T e^{-(r+\lambda)t}dt =  \lambda(1-\delta) \int_{0}^T e^{-(r+\lambda)t}dt)$$

$$C  =  \lambda(1-\delta)$$

We now know that the "fair" premium that Bob should pay is the rate at which the bond defaults every month $$\lambda$$ times the payout Bob receives if the bond does in fact default $$(1-\delta)$$. This is a pretty intuitive payment plan for Bob so he decides to buy the insurance policy from Alice, and just like we've got ourselves a good ol' fashioned fairly priced credit default swap. Note however that we could add additional complexity to our model. For example we can make the payout that Alice must give Bob dependent on when the bond defaults and/or we can augment the probability distribution $$\mathbb{P}(\tau>T_i)$$ and the interest rate $$r$$ to be time-dependent. 


Collateralized Debt Obligation
-----
A Collateralized Debt Obligation is a tiered bond made up of bonds. To understand what that means let’s model a simple example of CDO. Assume that Bob decides to buy 50 bonds $$B_i$$, each of which has a value of $$\$1$$. Make the following additional assumption about the bonds Bob bought.  

#### Assumptions
- (i) Let $$0=T_1 < T_1 < \dots < T_n = T, \quad \Delta t = \frac{T}{n}$$. (i.e there are $$n$$ months between Bob purchasing the bonds and the maturity date of the bond)
- (ii) If the bonds defaults at time $$\tau$$ such that $$T_{i-1}<\tau \leq T_i$$ then the bond owner recovers nothing. 
- (iii) The probability of any bond defaulting any time after month $$T_i$$ is $$\mathbb{P}(\tau > T_i) = e^{-\lambda t}$$. 
- (v) $$r=0$$ is the constant interest rate during the $$n$$ months Bob owns the bond. 

 One day Bob elects to sell his 50 bonds, but instead of selling each separately he combines them into three separate equities; The A,B,C tranche. 

- A Traunch: 10 Bonds
- B Traunch: 35 Bonds
- C Traunch: 5 Bonds

He tells his customers that if 2 bonds default by maturity time $$T$$ then the C tranche is left with $$3$$ bonds while the A and B tranches aren't impacted. If $$15$$ bonds default by time $$T$$ then the C tranche is left with nothing, while the B tranche is left with $$20$$ bonds and the A tranche isn't impacted. You can think of this as a sort of padding. The better the tranche the more defaults you can absorb before you take a loss. After designing this system Bob calls his security a collateralized debt obligation and needs to figure out how to price each tranche for his customers. He decides that each tranche should be priced according to its expected value by time $$T$$. The expected value of tranche A,B, and C are denoted as $$a_0,b_0,c_0$$ respectively. To formalize each expected value, we introduce some notation. First $$(x)^+ := \max(0,x)$$ and $$N$$ is the number of surviving bonds at maturity time $$T$$. 

$$a_0 = \mathbb{E}[\min(N,10)]$$

$$b_0 = \mathbb{E}[\min(35,(N-10)^+)]$$ 

$$c_0 = \mathbb{E}[\min(5, (N-45)^+)]$$

While these equations may seem a little strange, they are fairly descriptive. Take $$a_0$$ for example. If the number of surviving bonds $$N<10$$ then the owners of the A tranche get to keep the payouts of the remaining bonds each of which is worth $$\$1$$ at maturity. This means that the expected value of the A tranche is simply the expected number of surviving bonds capped at 10. We can follow a similar process to justify $$b_0$$ and $$c_0$$. To compute $$a_0,b_0,c_0$$ we need the probability distribution of $$N \sim \text{# Surviving Bonds}$$, since it’s the random variable we are taking expectations over. However, this joint distribution is wildly complicated, since in the real world if bond $$B_1$$ fails then that may be correlated to the failure of Bond $$B_2$$. And if bonds $$B_2 and B_10$$ fail at exactly time $$t$$ then that may be correlated to the probability that bond $$B_49$$ fails before $$T$$. You can imagine how finding such a probability distribution becomes very difficult very quickly. Its for this reason that Wall Street quants in 2008 took a short cut and decided to swap out this messy joint distribution for a known distribution called the Gaussian Copula. I'll let Felix Salmon [explain](https://www.wired.com/2009/02/wp-quant/ "The Formula That Killed Wall Street"). For our purposes we will assume that the failure of bond $$B_i$$ is independent and identically distributed to the failure of bond $$B_j$$. Note that this assumption is by no means grounded in reality and only serves the purpose of making the following computations easier to deal with. With that we note the following probabilities, where $$\{\tau_i\}_{i=1}^{50}$$ are the default times of each of Bob's 50 bonds. 

$$\mathbb{P}(N=0) = \mathbb{P}(\tau_1 \leq T, \dots, \tau_{50} \leq T) = \prod_{i=1}^{50}\mathbb{P}(\tau_i \leq T) = (1-e^{-\lambda T})^{50}$$

$$\mathbb{P}(N=1) = \mathbb{P}(\tau_1 > T, \tau_2 \leq T, \dots, \tau_{50} \leq T) = 50(e^{-\lambda T})(1-e^{-\lambda T})^{49}$$

$$\vdots$$

$$\mathbb{P}(N=k) = \binom{50}{k}(e^{-\lambda T})^k(1-e^{-\lambda T})^{50-k}$$

Now we can expand $$a_0,b_0,c_0$$

$$a_0 = \sum_{k=0}^9 k\mathbb{P}(N=k) + 10\sum_{k=10}^{50} \mathbb{P}(N=k)$$

$$b_0 = \mathbb{E}[\min(35, (N - 10)^+)] = \sum_{k=0}^{10} 0 \cdot \mathbb{P}(N = k) + \sum_{k=11}^{44} (k - 10) \, \mathbb{P}(N = k) + \sum_{k=45}^{50} 35 \, \mathbb{P}(N = k)$$

$$b_0 = \sum_{k=11}^{44} (k - 10) \, \mathbb{P}(N = k) + 35 \sum_{k=45}^{50} \mathbb{P}(N = k)$$


$$c_0 = \mathbb{E}[\min(5, (N - 45)^+)] = \sum_{k=0}^{45} 0 \cdot \mathbb{P}(N = k) + \sum_{k=46}^{49} (k - 45) \, \mathbb{P}(N = k) + \sum_{k=50}^{50} 5 \cdot \mathbb{P}(N = k)$$

$$c_0 = \sum_{k=46}^{49} (k - 45) \, \mathbb{P}(N = k) + 5 \cdot \mathbb{P}(N = 50)$$

Just like that we have "fair" prices for each tranche in Bob's CDO. You now have the tools to understand and model what Micheal Burry did when he bought a credit default swap on a collateralized debt obligation. All he did was buy the bank's insurance on security that contained a whole lot of bonds. Simple as that! 
 


